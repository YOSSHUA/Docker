# Docker reference

# Terminology


## Container

<br>

A container is a standard unit of software that packages up code and all its dependencies so the application runs quickly and reliably from one computing environment to another. To see all the containers in your machine type `docker container ls`.

<br>

## Container image

<br>

It is a lightweight, standalone, executable package of software that includes everything needed to run an application: code, runtime, system tools, system libraries and settings. To list all the images in your machine type `docker images`.


Container images become containers at runtime.

<br>

## Dockerfile

<br>

It's simply a text-based script of instructions that is used to create a container image. Example of a simple image:

```docker
FROM ubuntu:18.04
COPY . /app
RUN make /app
CMD python /app/app.py
```
Each instruction creates one layer:

- `FROM` creates a layer from the ubuntu:18.04 Docker image.
- `COPY` adds files from your Docker client’s current directory.
- `RUN` builds your application with make.
- `CMD` is the default command to run when starting a container from this image.

<br>

### Building the container image

<br>

We will use the following command in the terminal to build the image container with the Dockerfile:
```
docker build -t <image-name> .
```

- `-t` flag tags our image as `ìmage-name`.
- The . at the end of the docker build command tells that Docker should look for the Dockerfile in the current directory.

<br>

### Run a container given certain image container

<br>

```
docker run -d -p <host port>:<container port> <image-name>
```

* `-d` run the container in detached mode(in the background)
* `-p <host-port>:<container-port>` map the host port to the container port
* `<image-name>` is the image to use

<br>

### Checking status of containers running

<br>

The command  `docker ps` shows the information of our container running.

<br>

### Stop the container

<br>

To stop the container type `docker stop <container-id>`. The ID is shown with `docker ps`.

<br>

### Execute command in the container

<br>

To execute a command in the container's shell you should run the following command
```
docker exec <container-id> <YOUR-COMMAND>
```

<br>



# Manage data in Docker

<br>

By default all files created inside a container are stored on a writable container layer. This means that:

- The data doesn’t persist when that container no longer exists, and it can be difficult to get the data out of the container if another process needs it.

Docker has two options for containers to store files in the host machine, so that the files are persisted even after the container stops: volumes, and bind mounts. 

<br>

## Container volumes

<br>

File systems mounted on Docker containers to preserve data generated by the running container. To list all the volumes type `docker volume ls`.
<br>

### Create volume
<br>

To create a volume type `docker volume create <volume-name>`

<br>

### See volume information
<br>

To see the relevant information of your volume you have to run `docker volume inspect <volume-name>`.

<br>

### Delete volume

<br>

To create a volume type `docker volume prune <volume-name>`

<br>

### Attach volume to container

<br>

To acces files in volume within the container you should run the following command: 

```docker run -dp <host port>:<container port> -v <volume-name>:<path-in-container> <image-name>```

<br>



## Bind mounts

<br>

File or folder stored anywhere on the container host filesystem, the bind mount is mounted into a running container. We can use a bind mount to mount our source code into the container to let it see code changes, respond, and let us see the changes right away.
To mount it you should type ```docker run -dp <host port>:<container port> -v <path-in-host>:<path-in-container> <image-name>```

-  `-v` flag to specify a volume mount. We will mount the volume in `<path-in-container>`, which will capture all files created at the path.


<br>

Comparison between Named volumes and Bind mounts

![](volumeTypes.png)


# Networking 

By default containers run in isolation and don't know anything about other processes or containers on the same machine. The only rule is 

**If two containers are on the same network, they can talk each other. If they aren't, they can't.**

### Create network

To create a network type the following command ```docker network create <network-name>``` 

### Connect container to a network

To connect a container to a network during start type ```docker run -d --network <network-name> --network-alias <container-alias-in-network> <image-name>```

# References:

Getting started [tutorial](https://github.com/docker/getting-started).

Docker [documentation](https://www.docker.com/resources/what-container).


